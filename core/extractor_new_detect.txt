    def _detect_magic_handlers(self, archive_path: str) -> List[Any]:
        """Detect potential handlers based on magic bytes."""
        try:
            with open(archive_path, 'rb') as f:
                magic = f.read(262)
            
            handlers = []
            # ZIP
            if magic.startswith(b'PK\x03\x04'):
                handlers.append(self._extract_zip)
            # 7z
            if magic.startswith(b'7z\xbc\xaf\x27\x1c'):
                handlers.append(self._extract_7z)
            # RAR
            if magic.startswith(b'Rar!\x1a\x07'):
                handlers.append(self._extract_rar)
            # TAR and its compressed variants
            if any(magic.startswith(m) for m in [b'\x1f\x8b', b'BZh', b'\xfd7zXZ\x00', b'(\xb5/\xfd']): # GZip, BZip2, XZ, Zstd
                handlers.append(self._extract_tar)
                if HAS_LIBARCHIVE:
                    handlers.append(self._extract_libarchive)
            # TAR (ustar)
            if b'ustar' in magic[257:262]:
                handlers.append(self._extract_tar)
            # MSI/OLE
            if magic.startswith(b'\xd0\xcf\x11\xe0\xa1\xb1\x1a\xe1'):
                if HAS_MSI:
                    handlers.append(self._extract_msi)
                if HAS_LIBARCHIVE:
                    handlers.append(self._extract_libarchive)
            # EXE
            if magic.startswith(b'MZ'):
                if HAS_PEFILE:
                    handlers.append(self._extract_exe)
                if HAS_7Z:
                    handlers.append(self._extract_7z)
                handlers.append(self._extract_zip)
                if HAS_LIBARCHIVE:
                    handlers.append(self._extract_libarchive)
            return handlers
        except Exception:
            return []
